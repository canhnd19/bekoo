import{bX as Z,bF as j,at as q,J,b as _,e as O,bI as Y,a_ as L,z as I,aX as Q,bQ as P,c2 as F,bS as ee,ay as M,X as x,a5 as p,d as oe,s as ne,r as N,be as te,bb as le,aK as se,c3 as ae,y as E,b9 as ue,c4 as ie,Z as de,M as re,A as ce,ah as fe,c5 as w}from"./index-DSdE6rLa.js";import{U as R,u as k}from"./use-form-item-gQc69dN8.js";import{t as ye}from"./BaseIcon.vue_vue_type_script_setup_true_lang-BtQU6Rww.js";import{g as me}from"./scroll-D-m8eRfi.js";import{i as ve}from"./el-popper-BV_a2PBr.js";function Be(e,o,n){var a=e==null?0:e.length;if(!a)return-1;var t=0;return Z(e,j(o),t)}const Le=(...e)=>o=>{e.forEach(n=>{q(n)?n(o):n.value=o})};var b=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(b||{});const Ee=(e,o={})=>{J(e)||ye("[useLockscreen]","You need to pass a ref param to this function");const n=o.ns||_("popup"),a=O(()=>n.bm("parent","hidden"));if(!Y||L(document.body,a.value))return;let t=0,u=!1,l="0";const r=()=>{setTimeout(()=>{ee(document==null?void 0:document.body,a.value),u&&document&&(document.body.style.width=l)},200)};I(e,c=>{if(!c){r();return}u=!L(document.body,a.value),u&&(l=document.body.style.width),t=me(n.namespace.value);const i=document.documentElement.clientHeight<document.body.scrollHeight,f=Q(document.body,"overflowY");t>0&&(i||f==="scroll")&&u&&(document.body.style.width=`calc(100% - ${t}px)`),P(document.body,a.value)}),F(()=>r())},be=e=>{if(!e)return{onClick:M,onMousedown:M,onMouseup:M};let o=!1,n=!1;return{onClick:l=>{o&&n&&e(l),o=n=!1},onMousedown:l=>{o=l.target===l.currentTarget},onMouseup:l=>{n=l.target===l.currentTarget}}},pe=x({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:p([String,Array,Object])},zIndex:{type:p([String,Number])}}),Ce={click:e=>e instanceof MouseEvent},Se="overlay";var Te=oe({name:"ElOverlay",props:pe,emits:Ce,setup(e,{slots:o,emit:n}){const a=_(Se),t=c=>{n("click",c)},{onClick:u,onMousedown:l,onMouseup:r}=be(e.customMaskEvent?void 0:t);return()=>e.mask?ne("div",{class:[a.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:u,onMousedown:l,onMouseup:r},[N(o,"default")],b.STYLE|b.CLASS|b.PROPS,["onClick","onMouseup","onMousedown"]):te("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[N(o,"default")])}});const Ne=Te,Ae=x({center:Boolean,alignCenter:Boolean,closeIcon:{type:le},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),we={close:()=>!0},ke=x({...Ae,appendToBody:Boolean,appendTo:{type:p([String,Object]),default:"body"},beforeClose:{type:p(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),_e={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[R]:e=>se(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Ye=(e,o)=>{var n;const t=fe().emit,{nextZIndex:u}=ae();let l="";const r=k(),c=k(),i=E(!1),f=E(!1),v=E(!1),C=E((n=e.zIndex)!=null?n:u());let y,m;const z=ue("namespace",ie),H=O(()=>{const s={},d=`--${z.value}-dialog`;return e.fullscreen||(e.top&&(s[`${d}-margin-top`]=e.top),e.width&&(s[`${d}-width`]=de(e.width))),s}),U=O(()=>e.alignCenter?{display:"flex"}:{});function g(){t("opened")}function G(){t("closed"),t(R,!1),e.destroyOnClose&&(v.value=!1)}function V(){t("close")}function D(){m==null||m(),y==null||y(),e.openDelay&&e.openDelay>0?{stop:y}=w(()=>B(),e.openDelay):B()}function S(){y==null||y(),m==null||m(),e.closeDelay&&e.closeDelay>0?{stop:m}=w(()=>A(),e.closeDelay):A()}function T(){function s(d){d||(f.value=!0,i.value=!1)}e.beforeClose?e.beforeClose(s):S()}function K(){e.closeOnClickModal&&T()}function B(){Y&&(i.value=!0)}function A(){i.value=!1}function X(){t("openAutoFocus")}function $(){t("closeAutoFocus")}function h(s){var d;((d=s.detail)==null?void 0:d.focusReason)==="pointer"&&s.preventDefault()}e.lockScroll&&Ee(i);function W(){e.closeOnPressEscape&&T()}return I(()=>e.modelValue,s=>{s?(f.value=!1,D(),v.value=!0,C.value=ve(e.zIndex)?u():C.value++,re(()=>{t("open"),o.value&&(o.value.scrollTop=0)})):i.value&&S()}),I(()=>e.fullscreen,s=>{o.value&&(s?(l=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=l)}),ce(()=>{e.modelValue&&(i.value=!0,v.value=!0,D())}),{afterEnter:g,afterLeave:G,beforeLeave:V,handleClose:T,onModalClick:K,close:S,doClose:A,onOpenAutoFocus:X,onCloseAutoFocus:$,onCloseRequested:W,onFocusoutPrevented:h,titleId:r,bodyId:c,closed:f,style:H,overlayDialogStyle:U,rendered:v,visible:i,zIndex:C}};export{Ne as E,_e as a,Ae as b,Le as c,ke as d,we as e,Be as f,be as g,Ye as u};
