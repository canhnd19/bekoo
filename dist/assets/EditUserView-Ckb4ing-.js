import{_ as De}from"./BaseButton-B7q66_TX.js";import{_ as je}from"./BaseSelect-CnDWmlYb.js";import{d as Le,j as Pe,l as Te,A as Fe,y as d,al as me,I as D,e as j,f as o,o as r,m as b,c as m,a as t,s as i,p as u,n as L,v as U,F as x,an as Se,H as P,ao as He,ap as Re,K as qe,q as T,t as F,J as S,_ as ze}from"./index-Btw4ZPuZ.js";import{E as Oe}from"./el-select-BBSQdL7e.js";import{a as We,E as Me}from"./el-form-item-Bawm2C5X.js";/* empty css                 */import{E as $e}from"./el-progress-B0hc5wLz.js";import{_ as Ge}from"./BaseIcon.vue_vue_type_script_setup_true_lang-D9ePeB-z.js";import{_ as Je}from"./PageLoading-CEJatZ7n.js";import{E as Ke}from"./index-qdvhN_sN.js";import"./use-form-item-BCflGjGc.js";import"./el-scrollbar-BPL2oo3y.js";import"./el-popper-B6ZbGNft.js";import"./castArray-C3sH0s2q.js";import"./index-1LAnpCIA.js";import"./index-Dsc_ZqMb.js";const Qe={key:1,class:"min-h-screen bg-[#e8f2f7]"},Xe={class:"container space-y-4 px-20 pb-6"},Ye={class:"flex justify-between"},Ze={class:"flex w-[500px] justify-center"},et={class:"relative w-40"},tt=["src"],nt={class:"border-border-table rounded-full border border-solid bg-white p-2"},ot=["onClick"],at={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},st={class:"style-flex h-[102px]"},lt=["onClick"],it={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},dt=["onClick"],rt={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},ct={class:"style-flex h-[102px]"},ut={class:"space-y-2"},pt={class:"flex justify-end"},mt={class:"style-flex"},ft={class:"space-y-2"},vt={class:"space-y-2"},ht={class:"style-flex"},gt={class:"space-y-2"},yt={class:"space-y-2"},bt={class:"style-flex"},xt={class:"space-y-2"},_t={class:"space-y-2"},Vt={class:"flex justify-end"},Ct={class:"style-flex"},kt={class:"w-full space-y-2"},wt={class:"flex justify-end"},Ut=Le({__name:"EditUserView",setup(Et){var G,J,K,Q,X,Y,Z,ee,te,ne,oe,ae;const E=Pe(),{user:n,patient:p,getPatientInfo:fe}=Te();Fe(()=>{ve()});const h=d({}),N=d(!1),_=d(!1),v=d(!1),H=d([]),R=d([]),q=d([]),z=d(""),O=d((G=n.patient)!=null&&G.info?n.patient.info.province:n.doctor.info.province),W=d((J=n.patient)!=null&&J.info?n.patient.info.district:n.doctor.info.district),M=d((K=n.patient)!=null&&K.info?n.patient.info.commune:n.doctor.info.commune),$=d(""),l=d({name:(Q=n.patient)!=null&&Q.info?n.patient.info.name:n.doctor.info.name,province:(X=n.patient)!=null&&X.info?n.patient.info.province:n.doctor.info.province,district:(Y=n.patient)!=null&&Y.info?n.patient.info.district:n.doctor.info.district,commune:(Z=n.patient)!=null&&Z.info?n.patient.info.commune:n.doctor.info.commune,aboutAddress:(ee=n.patient)!=null&&ee.info?n.patient.info.aboutAddress:n.doctor.info.aboutAddress}),c=me({userId:(te=n.patient)!=null&&te.info?n.patient.info.id:n.doctor.info.id,healthInsuranceNumber:p.healthInsuranceNumber,bloodType:p.bloodType,emergencyContactCommand:{name:p.emergencyContacts?p.emergencyContacts[0].name:"",phone:p.emergencyContacts?(ne=p.emergencyContacts[0])==null?void 0:ne.phone:"",address:p.emergencyContacts?(oe=p.emergencyContacts[0])==null?void 0:oe.address:"",relationship:p.emergencyContacts?(ae=p.emergencyContacts[0])==null?void 0:ae.relationship:""}}),V=me({trainingBy:n.doctor?n.doctor.trainingBy:"",description:n.doctor?n.doctor.description:""}),C=d(!1),k=d(!1),w=d(!1),ve=async()=>{try{N.value=!0;const s=await D.getListProvince();H.value=s,N.value=!1}catch(s){console.log(s)}},he=async()=>{try{const s=await D.getListDistrict(z.value);R.value=s.districts}catch(s){console.log(s)}},ge=async()=>{try{const s=await D.getListWards($.value);q.value=s.wards}catch(s){console.log(s)}},ye=()=>{l.value.province?C.value=!1:C.value=!0},be=j(()=>!l.value.district),xe=()=>{if(l.value.province)l.value.district?k.value=!1:k.value=!0;else return},_e=j(()=>!l.value.commune),Ve=()=>{if(l.value.district)l.value.commune?w.value=!1:w.value=!0;else return},Ce=j(()=>!(l.value.commune&&l.value.district&&l.value.name&&l.value.province)),ke=async()=>{var s;try{_.value=!0,h.value&&Object.keys(h.value).length!==0&&await Ue();const e={...l.value,id:(s=n.patient)!=null&&s.info?n.patient.info.id:n.doctor.info.id,province:O.value,district:W.value,commune:M.value},g=await Se.editUser(e);P.success(g.message),E.push({name:"Home"}),_.value=!1}catch(e){_.value=!1,console.log(e)}},we=async s=>{var e;h.value=s,(e=n.patient)!=null&&e.info?n.patient.info.linkAvatar=URL.createObjectURL(h.value.raw):n.doctor.info.linkAvatar=URL.createObjectURL(h.value.raw)},Ue=async()=>{var e;const s=new FormData;s.append("fileImage",h.value.raw),s.append("id",(e=n.patient)!=null&&e.info?n.patient.info.id:n.doctor.info.id),await He.uploadFile(s)},Ee=async()=>{try{v.value=!0;const s=await Re.updatePatientInfo(c);await fe(),P.success(s.message),E.push({name:"Home"}),v.value=!1}catch(s){v.value=!1,console.log(s)}},Ne=async()=>{var s;try{v.value=!0;const e={id:(s=n.doctor)==null?void 0:s.id,trainingBy:V.trainingBy,description:V.description},g=await qe.editDoctor(e);P.success(g.message),E.push({name:"Home"}),v.value=!1}catch(e){v.value=!1,console.log(e)}};return(s,e)=>{var le,ie,de,re,ce,ue,pe;const g=Je,se=Ge,Be=$e,f=Ke,Ie=Me,Ae=We,B=Oe,I=je,A=De;return o(N)?(r(),b(g,{key:0})):(r(),m("div",Qe,[t("div",Xe,[e[30]||(e[30]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin cá nhân",-1)),t("div",Ye,[t("div",Ze,[t("div",et,[(le=o(n).doctor)!=null&&le.info.linkAvatar||(ie=o(n).patient)!=null&&ie.info.linkAvatar?(r(),m("img",{key:1,src:(de=o(n).patient)!=null&&de.info?(re=o(n).patient)==null?void 0:re.info.linkAvatar:(ce=o(n).doctor)==null?void 0:ce.info.linkAvatar,alt:"",class:"h-40 w-full rounded-full object-cover"},null,8,tt)):(r(),b(se,{key:0,name:"avatar-default",size:"170"})),i(Be,{"show-file-list":!1,"auto-upload":!1,accept:".png, .jpg, .webp, .jpeg","on-change":we,class:"absolute bottom-5 right-2"},{default:u(()=>[t("div",nt,[i(se,{name:"edit-avatar"})])]),_:1})])]),t("div",null,[t("div",null,[e[12]||(e[12]=t("div",null,[t("span",{class:"text-label"},"Họ và tên (có dấu) "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(Ae,{ref:"formRef",style:{"max-width":"500px"},model:o(l),"label-width":"auto",class:"demo-ruleForm"},{default:u(()=>[i(Ie,{prop:"name",rules:[{required:!0,message:"Vui lòng nhập họ và tên",trigger:"blur"}]},{default:u(()=>[i(f,{modelValue:o(l).name,"onUpdate:modelValue":e[0]||(e[0]=a=>o(l).name=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"VÍ DỤ: NGỌ ĐỨC CẢNH"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),t("div",null,[e[13]||(e[13]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Tỉnh / Thành "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:o(l).province,"onUpdate:modelValue":e[1]||(e[1]=a=>o(l).province=a),class:L([{"validate-select":o(C)},"select"]),clearable:"",placeholder:"Chọn tỉnh thành",onChange:he,onBlur:ye},{default:u(()=>[(r(!0),m(x,null,T(o(H),(a,y)=>(r(),b(B,{key:y,value:a.code,label:a.name},{default:u(()=>[t("p",{onClick:()=>{O.value=a.name,z.value=a.code}},F(a.name),9,ot)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class"]),o(C)?(r(),m("p",at,"Vui lòng chọn tỉnh/thành")):U("",!0)])])]),t("div",st,[t("div",null,[e[14]||(e[14]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Quận / Huyện "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:o(l).district,"onUpdate:modelValue":e[2]||(e[2]=a=>o(l).district=a),class:L([{"validate-select":o(k)},"select"]),clearable:"",placeholder:"Chọn quận huyện",disabled:o(be),onChange:ge,onBlur:xe},{default:u(()=>[(r(!0),m(x,null,T(o(R),(a,y)=>(r(),b(B,{key:y,value:a.code,label:a.name},{default:u(()=>[t("p",{onClick:()=>{W.value=a.name,$.value=a.code}},F(a.name),9,lt)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class","disabled"]),o(k)?(r(),m("p",it,"Vui lòng chọn quận/huyện")):U("",!0)]),t("div",null,[e[15]||(e[15]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Phường / Xã "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:o(l).commune,"onUpdate:modelValue":e[3]||(e[3]=a=>o(l).commune=a),class:L([{"validate-select":o(w)},"select"]),clearable:"",placeholder:"Chọn phường xã",disabled:o(_e),onBlur:Ve},{default:u(()=>[(r(!0),m(x,null,T(o(q),(a,y)=>(r(),b(B,{key:y,value:a.code,label:a.name},{default:u(()=>[t("p",{onClick:()=>{M.value=a.name}},F(a.name),9,dt)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class","disabled"]),o(w)?(r(),m("p",rt,"Vui lòng chọn phường/xã")):U("",!0)])]),t("div",ct,[t("div",ut,[e[16]||(e[16]=t("p",{class:"text-label"},"Địa chỉ hiện tại",-1)),i(f,{modelValue:o(l).aboutAddress,"onUpdate:modelValue":e[4]||(e[4]=a=>o(l).aboutAddress=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập địa chỉ hiện tại"},null,8,["modelValue"])])]),t("div",pt,[i(A,{disabled:o(Ce),loading:o(_),size:"large",class:"w-36",onClick:ke},{default:u(()=>e[17]||(e[17]=[S("Sửa")])),_:1},8,["disabled","loading"])]),(ue=o(n).patient)!=null&&ue.info.id?(r(),m(x,{key:0},[e[25]||(e[25]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin bệnh nhân",-1)),t("div",mt,[t("div",ft,[e[18]||(e[18]=t("p",{class:"text-label"},"Số bảo hiểm y tế",-1)),i(f,{modelValue:o(c).healthInsuranceNumber,"onUpdate:modelValue":e[5]||(e[5]=a=>o(c).healthInsuranceNumber=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập số bảo hiểm y tế"},null,8,["modelValue"])]),t("div",vt,[e[19]||(e[19]=t("p",{class:"text-label"},"Nhóm máu",-1)),i(f,{modelValue:o(c).bloodType,"onUpdate:modelValue":e[6]||(e[6]=a=>o(c).bloodType=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập nhóm máu"},null,8,["modelValue"])])]),e[26]||(e[26]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin liên hệ khẩn cấp",-1)),t("div",ht,[t("div",gt,[e[20]||(e[20]=t("p",{class:"text-label"},"Tên",-1)),i(f,{modelValue:o(c).emergencyContactCommand.name,"onUpdate:modelValue":e[7]||(e[7]=a=>o(c).emergencyContactCommand.name=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập tên người liên hệ khẩn cấp"},null,8,["modelValue"])]),t("div",yt,[e[21]||(e[21]=t("p",{class:"text-label"},"Số điện thoại",-1)),i(f,{modelValue:o(c).emergencyContactCommand.phone,"onUpdate:modelValue":e[8]||(e[8]=a=>o(c).emergencyContactCommand.phone=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập số điện thoại người liên hệ khẩn cấp"},null,8,["modelValue"])])]),t("div",bt,[t("div",xt,[e[22]||(e[22]=t("p",{class:"text-label"},"Địa chỉ",-1)),i(f,{modelValue:o(c).emergencyContactCommand.address,"onUpdate:modelValue":e[9]||(e[9]=a=>o(c).emergencyContactCommand.address=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập địa chỉ người liên hệ khẩn cấp"},null,8,["modelValue"])]),t("div",_t,[e[23]||(e[23]=t("p",{class:"text-label"},"Mối quan hệ với bênh nhân",-1)),i(f,{modelValue:o(c).emergencyContactCommand.relationship,"onUpdate:modelValue":e[10]||(e[10]=a=>o(c).emergencyContactCommand.relationship=a),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập mối quan hệ giữa người liên hệ khẩn cấp và bệnh nhân"},null,8,["modelValue"])])]),t("div",Vt,[i(A,{loading:o(v),size:"large",class:"w-40",onClick:Ee},{default:u(()=>e[24]||(e[24]=[S("Cập nhật")])),_:1},8,["loading"])])],64)):(pe=o(n).doctor)!=null&&pe.id?(r(),m(x,{key:1},[e[29]||(e[29]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin nghề nghiệp",-1)),t("div",Ct,[t("div",kt,[e[27]||(e[27]=t("p",{class:"text-label"},"Mô tả",-1)),i(f,{modelValue:o(V).description,"onUpdate:modelValue":e[11]||(e[11]=a=>o(V).description=a),class:"input",autosize:{minRows:2},type:"textarea",placeholder:"Vui lòng nhập mô tả"},null,8,["modelValue"])])]),t("div",wt,[i(A,{loading:o(v),size:"large",class:"w-36",onClick:Ne},{default:u(()=>e[28]||(e[28]=[S("Sửa")])),_:1},8,["loading"])])],64)):U("",!0)])]))}}}),Wt=ze(Ut,[["__scopeId","data-v-cba1324c"]]);export{Wt as default};
