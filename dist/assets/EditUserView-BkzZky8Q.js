import{_ as De}from"./BaseButton-UPu0h8fx.js";import{_ as Le}from"./BaseSelect-B4IODFBV.js";import{d as Pe,j as Te,l as je,A as Fe,y as d,af as me,I as D,e as L,f as n,o as r,m as x,c as f,a as t,s as i,p as u,n as P,v as U,F as V,ag as Re,H as T,ah as Se,ai as ze,K as He,q as j,t as F,J as R,_ as qe}from"./index-0e2ZwpIP.js";import{E as Me}from"./el-select-DflWEOO5.js";import{a as We,E as Oe}from"./el-form-item-DOE3Iz6l.js";/* empty css                 */import{E as $e}from"./el-progress-1vxZ3IeH.js";import{_ as Ge}from"./BaseIcon.vue_vue_type_script_setup_true_lang-DuVLXA2z.js";import{_ as Je}from"./PageLoading-BAyd_tPS.js";import{E as Ke}from"./index-Dt94axWr.js";import"./index-DZSyEbGV.js";import"./el-scrollbar-DFu_LuAL.js";import"./el-popper-BqMQlbYD.js";import"./use-form-item-iAylP33e.js";import"./castArray-Cfs9ZCeP.js";import"./index-pfNX6fsS.js";const Qe={key:1,class:"min-h-screen bg-[#e8f2f7]"},Xe={class:"container space-y-4 px-20 pb-6"},Ye={class:"flex justify-between"},Ze={class:"flex w-[500px] justify-center"},et={class:"relative w-40"},tt=["src"],nt={class:"border-border-table rounded-full border border-solid bg-white p-2"},ot=["onClick"],st={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},lt={class:"style-flex h-[102px]"},at=["onClick"],it={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},dt=["onClick"],rt={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},ct={class:"style-flex h-[102px]"},ut={class:"space-y-2"},pt={class:"flex justify-end"},mt={class:"style-flex"},ft={class:"space-y-2"},vt={class:"space-y-2"},ht={class:"style-flex"},gt={class:"space-y-2"},yt={class:"space-y-2"},bt={class:"style-flex"},xt={class:"space-y-2"},Vt={class:"space-y-2"},_t={class:"flex justify-end"},Ct={class:"style-flex"},wt={class:"space-y-2"},kt={class:"space-y-2"},Ut={class:"flex justify-end"},Et=Pe({__name:"EditUserView",setup(Bt){var G,J,K,Q,X,Y,Z,ee,te,ne,oe,se;const E=Te(),{user:o,patient:p,getPatientInfo:fe}=je();Fe(()=>{ve()});const g=d({}),B=d(!1),_=d(!1),v=d(!1),S=d([]),z=d([]),H=d([]),q=d(""),M=d((G=o.patient)!=null&&G.info?o.patient.info.province:o.doctor.info.province),W=d((J=o.patient)!=null&&J.info?o.patient.info.district:o.doctor.info.district),O=d((K=o.patient)!=null&&K.info?o.patient.info.commune:o.doctor.info.commune),$=d(""),a=d({name:(Q=o.patient)!=null&&Q.info?o.patient.info.name:o.doctor.info.name,province:(X=o.patient)!=null&&X.info?o.patient.info.province:o.doctor.info.province,district:(Y=o.patient)!=null&&Y.info?o.patient.info.district:o.doctor.info.district,commune:(Z=o.patient)!=null&&Z.info?o.patient.info.commune:o.doctor.info.commune,aboutAddress:(ee=o.patient)!=null&&ee.info?o.patient.info.aboutAddress:o.doctor.info.aboutAddress}),c=me({userId:(te=o.patient)!=null&&te.info?o.patient.info.id:o.doctor.info.id,healthInsuranceNumber:p.healthInsuranceNumber,bloodType:p.bloodType,emergencyContactCommand:{name:p.emergencyContacts?p.emergencyContacts[0].name:"",phone:p.emergencyContacts?(ne=p.emergencyContacts[0])==null?void 0:ne.phone:"",address:p.emergencyContacts?(oe=p.emergencyContacts[0])==null?void 0:oe.address:"",relationship:p.emergencyContacts?(se=p.emergencyContacts[0])==null?void 0:se.relationship:""}}),h=me({trainingBy:o.doctor?o.doctor.trainingBy:"",description:o.doctor?o.doctor.description:""}),C=d(!1),w=d(!1),k=d(!1),ve=async()=>{try{B.value=!0;const l=await D.getListProvince();S.value=l,B.value=!1}catch(l){console.log(l)}},he=async()=>{try{const l=await D.getListDistrict(q.value);z.value=l.districts}catch(l){console.log(l)}},ge=async()=>{try{const l=await D.getListWards($.value);H.value=l.wards}catch(l){console.log(l)}},ye=()=>{a.value.province?C.value=!1:C.value=!0},be=L(()=>!a.value.district),xe=()=>{if(a.value.province)a.value.district?w.value=!1:w.value=!0;else return},Ve=L(()=>!a.value.commune),_e=()=>{if(a.value.district)a.value.commune?k.value=!1:k.value=!0;else return},Ce=L(()=>!(a.value.commune&&a.value.district&&a.value.name&&a.value.province)),we=async()=>{var l;try{_.value=!0,g.value&&await Ue();const e={...a.value,id:(l=o.patient)!=null&&l.info?o.patient.info.id:o.doctor.info.id,province:M.value,district:W.value,commune:O.value},y=await Re.editUser(e);T.success(y.message),E.push({name:"Home"}),_.value=!1}catch(e){_.value=!1,console.log(e)}},ke=async l=>{var e;g.value=l,(e=o.patient)!=null&&e.info?o.patient.info.linkAvatar=URL.createObjectURL(g.value.raw):o.doctor.info.linkAvatar=URL.createObjectURL(g.value.raw)},Ue=async()=>{var e;const l=new FormData;l.append("fileImage",g.value.raw),l.append("id",(e=o.patient)!=null&&e.info?o.patient.info.id:o.doctor.info.id),await Se.uploadFile(l)},Ee=async()=>{try{v.value=!0;const l=await ze.updatePatientInfo(c);await fe(),T.success(l.message),E.push({name:"Home"}),v.value=!1}catch(l){v.value=!1,console.log(l)}},Be=async()=>{var l;try{v.value=!0;const e={id:(l=o.doctor)==null?void 0:l.id,trainingBy:h.trainingBy,description:h.description},y=await He.editDoctor(e);T.success(y.message),E.push({name:"Home"}),v.value=!1}catch(e){v.value=!1,console.log(e)}};return(l,e)=>{var ae,ie,de,re,ce,ue,pe;const y=Je,le=Ge,Ne=$e,m=Ke,Ie=Oe,Ae=We,N=Me,I=Le,A=De;return n(B)?(r(),x(y,{key:0})):(r(),f("div",Qe,[t("div",Xe,[e[32]||(e[32]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin cá nhân",-1)),t("div",Ye,[t("div",Ze,[t("div",et,[(ae=n(o).doctor)!=null&&ae.info.linkAvatar||(ie=n(o).patient)!=null&&ie.info.linkAvatar?(r(),f("img",{key:1,src:(de=n(o).patient)!=null&&de.info?(re=n(o).patient)==null?void 0:re.info.linkAvatar:(ce=n(o).doctor)==null?void 0:ce.info.linkAvatar,alt:"",class:"h-40 w-full rounded-full object-cover"},null,8,tt)):(r(),x(le,{key:0,name:"avatar-default",size:"170"})),i(Ne,{"show-file-list":!1,"auto-upload":!1,accept:".png, .jpg, .webp, .jpeg","on-change":ke,class:"absolute bottom-5 right-2"},{default:u(()=>[t("div",nt,[i(le,{name:"edit-avatar"})])]),_:1})])]),t("div",null,[t("div",null,[e[13]||(e[13]=t("div",null,[t("span",{class:"text-label"},"Họ và tên (có dấu) "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(Ae,{ref:"formRef",style:{"max-width":"500px"},model:n(a),"label-width":"auto",class:"demo-ruleForm"},{default:u(()=>[i(Ie,{prop:"name",rules:[{required:!0,message:"Vui lòng nhập họ và tên",trigger:"blur"}]},{default:u(()=>[i(m,{modelValue:n(a).name,"onUpdate:modelValue":e[0]||(e[0]=s=>n(a).name=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"VÍ DỤ: NGỌ ĐỨC CẢNH"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),t("div",null,[e[14]||(e[14]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Tỉnh / Thành "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:n(a).province,"onUpdate:modelValue":e[1]||(e[1]=s=>n(a).province=s),class:P([{"validate-select":n(C)},"select"]),clearable:"",placeholder:"Chọn tỉnh thành",onChange:he,onBlur:ye},{default:u(()=>[(r(!0),f(V,null,j(n(S),(s,b)=>(r(),x(N,{key:b,value:s.code,label:s.name},{default:u(()=>[t("p",{onClick:()=>{M.value=s.name,q.value=s.code}},F(s.name),9,ot)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class"]),n(C)?(r(),f("p",st,"Vui lòng chọn tỉnh/thành")):U("",!0)])])]),t("div",lt,[t("div",null,[e[15]||(e[15]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Quận / Huyện "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:n(a).district,"onUpdate:modelValue":e[2]||(e[2]=s=>n(a).district=s),class:P([{"validate-select":n(w)},"select"]),clearable:"",placeholder:"Chọn quận huyện",disabled:n(be),onChange:ge,onBlur:xe},{default:u(()=>[(r(!0),f(V,null,j(n(z),(s,b)=>(r(),x(N,{key:b,value:s.code,label:s.name},{default:u(()=>[t("p",{onClick:()=>{W.value=s.name,$.value=s.code}},F(s.name),9,at)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class","disabled"]),n(w)?(r(),f("p",it,"Vui lòng chọn quận/huyện")):U("",!0)]),t("div",null,[e[16]||(e[16]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Phường / Xã "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:n(a).commune,"onUpdate:modelValue":e[3]||(e[3]=s=>n(a).commune=s),class:P([{"validate-select":n(k)},"select"]),clearable:"",placeholder:"Chọn phường xã",disabled:n(Ve),onBlur:_e},{default:u(()=>[(r(!0),f(V,null,j(n(H),(s,b)=>(r(),x(N,{key:b,value:s.code,label:s.name},{default:u(()=>[t("p",{onClick:()=>{O.value=s.name}},F(s.name),9,dt)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class","disabled"]),n(k)?(r(),f("p",rt,"Vui lòng chọn phường/xã")):U("",!0)])]),t("div",ct,[t("div",ut,[e[17]||(e[17]=t("p",{class:"text-label"},"Địa chỉ hiện tại",-1)),i(m,{modelValue:n(a).aboutAddress,"onUpdate:modelValue":e[4]||(e[4]=s=>n(a).aboutAddress=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập địa chỉ hiện tại"},null,8,["modelValue"])])]),t("div",pt,[i(A,{disabled:n(Ce),loading:n(_),size:"large",class:"w-36",onClick:we},{default:u(()=>e[18]||(e[18]=[R("Sửa")])),_:1},8,["disabled","loading"])]),(ue=n(o).patient)!=null&&ue.info.id?(r(),f(V,{key:0},[e[26]||(e[26]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin bệnh nhân",-1)),t("div",mt,[t("div",ft,[e[19]||(e[19]=t("p",{class:"text-label"},"Số bảo hiểm y tế",-1)),i(m,{modelValue:n(c).healthInsuranceNumber,"onUpdate:modelValue":e[5]||(e[5]=s=>n(c).healthInsuranceNumber=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập số bảo hiểm y tế"},null,8,["modelValue"])]),t("div",vt,[e[20]||(e[20]=t("p",{class:"text-label"},"Nhóm máu",-1)),i(m,{modelValue:n(c).bloodType,"onUpdate:modelValue":e[6]||(e[6]=s=>n(c).bloodType=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập nhóm máu"},null,8,["modelValue"])])]),e[27]||(e[27]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin liên hệ khẩn cấp",-1)),t("div",ht,[t("div",gt,[e[21]||(e[21]=t("p",{class:"text-label"},"Tên",-1)),i(m,{modelValue:n(c).emergencyContactCommand.name,"onUpdate:modelValue":e[7]||(e[7]=s=>n(c).emergencyContactCommand.name=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập tên người liên hệ khẩn cấp"},null,8,["modelValue"])]),t("div",yt,[e[22]||(e[22]=t("p",{class:"text-label"},"Số điện thoại",-1)),i(m,{modelValue:n(c).emergencyContactCommand.phone,"onUpdate:modelValue":e[8]||(e[8]=s=>n(c).emergencyContactCommand.phone=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập số điện thoại người liên hệ khẩn cấp"},null,8,["modelValue"])])]),t("div",bt,[t("div",xt,[e[23]||(e[23]=t("p",{class:"text-label"},"Địa chỉ",-1)),i(m,{modelValue:n(c).emergencyContactCommand.address,"onUpdate:modelValue":e[9]||(e[9]=s=>n(c).emergencyContactCommand.address=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập địa chỉ người liên hệ khẩn cấp"},null,8,["modelValue"])]),t("div",Vt,[e[24]||(e[24]=t("p",{class:"text-label"},"Mối quan hệ với bênh nhân",-1)),i(m,{modelValue:n(c).emergencyContactCommand.relationship,"onUpdate:modelValue":e[10]||(e[10]=s=>n(c).emergencyContactCommand.relationship=s),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập mối quan hệ giữa người liên hệ khẩn cấp và bệnh nhân"},null,8,["modelValue"])])]),t("div",_t,[i(A,{loading:n(v),size:"large",class:"w-40",onClick:Ee},{default:u(()=>e[25]||(e[25]=[R("Cập nhật")])),_:1},8,["loading"])])],64)):(pe=n(o).doctor)!=null&&pe.id?(r(),f(V,{key:1},[e[31]||(e[31]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin nghề nghiệp",-1)),t("div",Ct,[t("div",wt,[e[28]||(e[28]=t("p",{class:"text-label"},"Mô tả học vấn",-1)),i(m,{modelValue:n(h).trainingBy,"onUpdate:modelValue":e[11]||(e[11]=s=>n(h).trainingBy=s),class:"input",style:{width:"500px"},autosize:{minRows:2},type:"textarea",placeholder:"Vui lòng nhập mô tả"},null,8,["modelValue"])]),t("div",kt,[e[29]||(e[29]=t("p",{class:"text-label"},"Mô tả",-1)),i(m,{modelValue:n(h).description,"onUpdate:modelValue":e[12]||(e[12]=s=>n(h).description=s),class:"input",style:{width:"500px"},autosize:{minRows:2},type:"textarea",placeholder:"Vui lòng nhập mô tả"},null,8,["modelValue"])])]),t("div",Ut,[i(A,{loading:n(v),size:"large",class:"w-36",onClick:Be},{default:u(()=>e[30]||(e[30]=[R("Sửa")])),_:1},8,["loading"])])],64)):U("",!0)])]))}}}),Ot=qe(Et,[["__scopeId","data-v-a38f4775"]]);export{Ot as default};
