import{_ as De}from"./BaseButton-Di-A2jUA.js";import{_ as Pe}from"./BaseSelect-C8qEMj5g.js";import{d as je,j as Le,l as Te,B as Fe,x as d,ai as me,N as D,e as P,f as n,o as r,m as x,c as f,a as t,s as i,p as u,n as j,P as U,F as V,aj as Re,M as L,ak as Se,al as ze,Q as qe,q as T,t as F,O as R,_ as He}from"./index-D_BuvB-D.js";import{E as Me}from"./el-select-P_tVlLt1.js";import{a as Oe,E as We}from"./el-form-item-Bl-1_vlu.js";/* empty css                 */import{E as Qe}from"./el-progress-CmmB2xZh.js";import{_ as $e}from"./BaseIcon.vue_vue_type_script_setup_true_lang-LCufWN4S.js";import{_ as Ge}from"./PageLoading-B1QspXNe.js";import{E as Xe}from"./index-8MVXDdlr.js";import"./index-CF7afJg5.js";import"./el-scrollbar-B1CA6wtK.js";import"./el-popper-BujlmXIY.js";import"./use-form-item-B2wKpYSg.js";import"./castArray-BHAgoStK.js";import"./index-CaEhwcam.js";const Je={key:1,class:"min-h-screen bg-[#e8f2f7]"},Ke={class:"container space-y-4 px-20 pb-6"},Ye={class:"flex justify-between"},Ze={class:"flex w-[500px] justify-center"},et={class:"relative w-40"},tt=["src"],nt={class:"border-border-table rounded-full border border-solid bg-white p-2"},ot=["onClick"],lt={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},st={class:"style-flex h-[102px]"},at=["onClick"],it={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},dt=["onClick"],rt={key:0,class:"-!mt-1 text-xs text-[#f56c6c]"},ct={class:"style-flex h-[102px]"},ut={class:"space-y-2"},pt={class:"flex justify-end"},mt={class:"style-flex"},ft={class:"space-y-2"},vt={class:"space-y-2"},ht={class:"style-flex"},gt={class:"space-y-2"},yt={class:"space-y-2"},bt={class:"style-flex"},xt={class:"space-y-2"},Vt={class:"space-y-2"},_t={class:"flex justify-end"},Ct={class:"style-flex"},wt={class:"space-y-2"},kt={class:"space-y-2"},Ut={class:"flex justify-end"},Et=je({__name:"EditUserView",setup(Bt){var $,G,X,J,K,Y,Z,ee,te,ne,oe,le;const E=Le(),{user:o,patient:p,getPatientInfo:fe}=Te();Fe(()=>{ve()});const g=d({}),B=d(!1),_=d(!1),v=d(!1),S=d([]),z=d([]),q=d([]),H=d(""),M=d(($=o.patient)!=null&&$.info?o.patient.info.province:o.doctor.info.province),O=d((G=o.patient)!=null&&G.info?o.patient.info.district:o.doctor.info.district),W=d((X=o.patient)!=null&&X.info?o.patient.info.commune:o.doctor.info.commune),Q=d(""),a=d({name:(J=o.patient)!=null&&J.info?o.patient.info.name:o.doctor.info.name,province:(K=o.patient)!=null&&K.info?o.patient.info.province:o.doctor.info.province,district:(Y=o.patient)!=null&&Y.info?o.patient.info.district:o.doctor.info.district,commune:(Z=o.patient)!=null&&Z.info?o.patient.info.commune:o.doctor.info.commune,aboutAddress:(ee=o.patient)!=null&&ee.info?o.patient.info.aboutAddress:o.doctor.info.aboutAddress}),c=me({userId:(te=o.patient)!=null&&te.info?o.patient.info.id:o.doctor.info.id,healthInsuranceNumber:p.healthInsuranceNumber,bloodType:p.bloodType,emergencyContactCommand:{name:p.emergencyContacts?p.emergencyContacts[0].name:"",phone:p.emergencyContacts?(ne=p.emergencyContacts[0])==null?void 0:ne.phone:"",address:p.emergencyContacts?(oe=p.emergencyContacts[0])==null?void 0:oe.address:"",relationship:p.emergencyContacts?(le=p.emergencyContacts[0])==null?void 0:le.relationship:""}}),h=me({trainingBy:o.doctor?o.doctor.trainingBy:"",description:o.doctor?o.doctor.description:""}),C=d(!1),w=d(!1),k=d(!1),ve=async()=>{try{B.value=!0;const s=await D.getListProvince();S.value=s,B.value=!1}catch(s){console.log(s)}},he=async()=>{try{const s=await D.getListDistrict(H.value);z.value=s.districts}catch(s){console.log(s)}},ge=async()=>{try{const s=await D.getListWards(Q.value);q.value=s.wards}catch(s){console.log(s)}},ye=()=>{a.value.province?C.value=!1:C.value=!0},be=P(()=>!a.value.district),xe=()=>{if(a.value.province)a.value.district?w.value=!1:w.value=!0;else return},Ve=P(()=>!a.value.commune),_e=()=>{if(a.value.district)a.value.commune?k.value=!1:k.value=!0;else return},Ce=P(()=>!(a.value.commune&&a.value.district&&a.value.name&&a.value.province)),we=async()=>{var s;try{_.value=!0,g.value&&await Ue();const e={...a.value,id:(s=o.patient)!=null&&s.info?o.patient.info.id:o.doctor.info.id,province:M.value,district:O.value,commune:W.value},y=await Re.editUser(e);L.success(y.message),E.push({name:"Home"}),_.value=!1}catch(e){_.value=!1,console.log(e)}},ke=async s=>{var e;g.value=s,(e=o.patient)!=null&&e.info?o.patient.info.linkAvatar=URL.createObjectURL(g.value.raw):o.doctor.info.linkAvatar=URL.createObjectURL(g.value.raw)},Ue=async()=>{var e;const s=new FormData;s.append("fileImage",g.value.raw),s.append("id",(e=o.patient)!=null&&e.info?o.patient.info.id:o.doctor.info.id),await Se.uploadFile(s)},Ee=async()=>{try{v.value=!0;const s=await ze.updatePatientInfo(c);await fe(),L.success(s.message),E.push({name:"Home"}),v.value=!1}catch(s){v.value=!1,console.log(s)}},Be=async()=>{var s;try{v.value=!0;const e={id:(s=o.doctor)==null?void 0:s.id,trainingBy:h.trainingBy,description:h.description},y=await qe.editDoctor(e);L.success(y.message),E.push({name:"Home"}),v.value=!1}catch(e){v.value=!1,console.log(e)}};return(s,e)=>{var ae,ie,de,re,ce,ue,pe;const y=Ge,se=$e,Ne=Qe,m=Xe,Ie=We,Ae=Oe,N=Me,I=Pe,A=De;return n(B)?(r(),x(y,{key:0})):(r(),f("div",Je,[t("div",Ke,[e[32]||(e[32]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin cá nhân",-1)),t("div",Ye,[t("div",Ze,[t("div",et,[(ae=n(o).doctor)!=null&&ae.info.linkAvatar||(ie=n(o).patient)!=null&&ie.info.linkAvatar?(r(),f("img",{key:1,src:(de=n(o).patient)!=null&&de.info?(re=n(o).patient)==null?void 0:re.info.linkAvatar:(ce=n(o).doctor)==null?void 0:ce.info.linkAvatar,alt:"",class:"h-40 w-full rounded-full object-cover"},null,8,tt)):(r(),x(se,{key:0,name:"avatar-default",size:"170"})),i(Ne,{"show-file-list":!1,"auto-upload":!1,accept:".png, .jpg, .webp, .jpeg","on-change":ke,class:"absolute bottom-5 right-2"},{default:u(()=>[t("div",nt,[i(se,{name:"edit-avatar"})])]),_:1})])]),t("div",null,[t("div",null,[e[13]||(e[13]=t("div",null,[t("span",{class:"text-label"},"Họ và tên (có dấu) "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(Ae,{ref:"formRef",style:{"max-width":"500px"},model:n(a),"label-width":"auto",class:"demo-ruleForm"},{default:u(()=>[i(Ie,{prop:"name",rules:[{required:!0,message:"Vui lòng nhập họ và tên",trigger:"blur"}]},{default:u(()=>[i(m,{modelValue:n(a).name,"onUpdate:modelValue":e[0]||(e[0]=l=>n(a).name=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"VÍ DỤ: NGỌ ĐỨC CẢNH"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),t("div",null,[e[14]||(e[14]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Tỉnh / Thành "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:n(a).province,"onUpdate:modelValue":e[1]||(e[1]=l=>n(a).province=l),class:j([{"validate-select":n(C)},"select"]),clearable:"",placeholder:"Chọn tỉnh thành",onChange:he,onBlur:ye},{default:u(()=>[(r(!0),f(V,null,T(n(S),(l,b)=>(r(),x(N,{key:b,value:l.code,label:l.name},{default:u(()=>[t("p",{onClick:()=>{M.value=l.name,H.value=l.code}},F(l.name),9,ot)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class"]),n(C)?(r(),f("p",lt,"Vui lòng chọn tỉnh/thành")):U("",!0)])])]),t("div",st,[t("div",null,[e[15]||(e[15]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Quận / Huyện "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:n(a).district,"onUpdate:modelValue":e[2]||(e[2]=l=>n(a).district=l),class:j([{"validate-select":n(w)},"select"]),clearable:"",placeholder:"Chọn quận huyện",disabled:n(be),onChange:ge,onBlur:xe},{default:u(()=>[(r(!0),f(V,null,T(n(z),(l,b)=>(r(),x(N,{key:b,value:l.code,label:l.name},{default:u(()=>[t("p",{onClick:()=>{O.value=l.name,Q.value=l.code}},F(l.name),9,at)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class","disabled"]),n(w)?(r(),f("p",it,"Vui lòng chọn quận/huyện")):U("",!0)]),t("div",null,[e[16]||(e[16]=t("div",{class:"mb-2"},[t("span",{class:"text-label"},"Phường / Xã "),t("span",{class:"text-[#ff3b30]"},"*")],-1)),i(I,{modelValue:n(a).commune,"onUpdate:modelValue":e[3]||(e[3]=l=>n(a).commune=l),class:j([{"validate-select":n(k)},"select"]),clearable:"",placeholder:"Chọn phường xã",disabled:n(Ve),onBlur:_e},{default:u(()=>[(r(!0),f(V,null,T(n(q),(l,b)=>(r(),x(N,{key:b,value:l.code,label:l.name},{default:u(()=>[t("p",{onClick:()=>{W.value=l.name}},F(l.name),9,dt)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","class","disabled"]),n(k)?(r(),f("p",rt,"Vui lòng chọn phường/xã")):U("",!0)])]),t("div",ct,[t("div",ut,[e[17]||(e[17]=t("p",{class:"text-label"},"Địa chỉ hiện tại",-1)),i(m,{modelValue:n(a).aboutAddress,"onUpdate:modelValue":e[4]||(e[4]=l=>n(a).aboutAddress=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập địa chỉ hiện tại"},null,8,["modelValue"])])]),t("div",pt,[i(A,{disabled:n(Ce),loading:n(_),size:"large",class:"w-36",onClick:we},{default:u(()=>e[18]||(e[18]=[R("Sửa")])),_:1},8,["disabled","loading"])]),(ue=n(o).patient)!=null&&ue.id?(r(),f(V,{key:0},[e[26]||(e[26]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin bệnh nhân",-1)),t("div",mt,[t("div",ft,[e[19]||(e[19]=t("p",{class:"text-label"},"Số bảo hiểm y tế",-1)),i(m,{modelValue:n(c).healthInsuranceNumber,"onUpdate:modelValue":e[5]||(e[5]=l=>n(c).healthInsuranceNumber=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập số bảo hiểm y tế"},null,8,["modelValue"])]),t("div",vt,[e[20]||(e[20]=t("p",{class:"text-label"},"Nhóm máu",-1)),i(m,{modelValue:n(c).bloodType,"onUpdate:modelValue":e[6]||(e[6]=l=>n(c).bloodType=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Vui lòng nhập nhóm máu"},null,8,["modelValue"])])]),e[27]||(e[27]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin liên hệ khẩn cấp",-1)),t("div",ht,[t("div",gt,[e[21]||(e[21]=t("p",{class:"text-label"},"Tên",-1)),i(m,{modelValue:n(c).emergencyContactCommand.name,"onUpdate:modelValue":e[7]||(e[7]=l=>n(c).emergencyContactCommand.name=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập tên người liên hệ khẩn cấp"},null,8,["modelValue"])]),t("div",yt,[e[22]||(e[22]=t("p",{class:"text-label"},"Số điện thoại",-1)),i(m,{modelValue:n(c).emergencyContactCommand.phone,"onUpdate:modelValue":e[8]||(e[8]=l=>n(c).emergencyContactCommand.phone=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập số điện thoại người liên hệ khẩn cấp"},null,8,["modelValue"])])]),t("div",bt,[t("div",xt,[e[23]||(e[23]=t("p",{class:"text-label"},"Địa chỉ",-1)),i(m,{modelValue:n(c).emergencyContactCommand.address,"onUpdate:modelValue":e[9]||(e[9]=l=>n(c).emergencyContactCommand.address=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập địa chỉ người liên hệ khẩn cấp"},null,8,["modelValue"])]),t("div",Vt,[e[24]||(e[24]=t("p",{class:"text-label"},"Mối quan hệ với bênh nhân",-1)),i(m,{modelValue:n(c).emergencyContactCommand.relationship,"onUpdate:modelValue":e[10]||(e[10]=l=>n(c).emergencyContactCommand.relationship=l),class:"input",style:{height:"50px",width:"500px"},placeholder:"Nhập mối quan hệ giữa người liên hệ khẩn cấp và bệnh nhân"},null,8,["modelValue"])])]),t("div",_t,[i(A,{loading:n(v),size:"large",class:"w-40",onClick:Ee},{default:u(()=>e[25]||(e[25]=[R("Cập nhật")])),_:1},8,["loading"])])],64)):(pe=n(o).doctor)!=null&&pe.id?(r(),f(V,{key:1},[e[31]||(e[31]=t("div",{class:"pt-6 text-2xl font-bold"},"Thông tin nghề nghiệp",-1)),t("div",Ct,[t("div",wt,[e[28]||(e[28]=t("p",{class:"text-label"},"Mô tả học vấn",-1)),i(m,{modelValue:n(h).trainingBy,"onUpdate:modelValue":e[11]||(e[11]=l=>n(h).trainingBy=l),class:"input",style:{width:"500px"},autosize:{minRows:2},type:"textarea",placeholder:"Vui lòng nhập mô tả"},null,8,["modelValue"])]),t("div",kt,[e[29]||(e[29]=t("p",{class:"text-label"},"Mô tả",-1)),i(m,{modelValue:n(h).description,"onUpdate:modelValue":e[12]||(e[12]=l=>n(h).description=l),class:"input",style:{width:"500px"},autosize:{minRows:2},type:"textarea",placeholder:"Vui lòng nhập mô tả"},null,8,["modelValue"])])]),t("div",Ut,[i(A,{loading:n(v),size:"large",class:"w-36",onClick:Be},{default:u(()=>e[30]||(e[30]=[R("Sửa")])),_:1},8,["loading"])])],64)):U("",!0)])]))}}}),Wt=He(Et,[["__scopeId","data-v-15963e84"]]);export{Wt as default};
