import{d as y,y as s,z as N,A as S,o as p,c as D,a as c,m as f,p as B,f as b,q as Y,t as w,s as h,h as $,F as k,e as V,B as _,C as q}from"./index-BOsbCA5H.js";import{u as x}from"./useConvertUTCTime-I4Z56cTM.js";import{C as F,r as O,B as j}from"./BaseChart-CgeRCT3u.js";import{_ as U}from"./BaseIcon.vue_vue_type_script_setup_true_lang-DQPPPTb4.js";import{_ as W}from"./BaseLoading-DaWJCDRZ.js";import{S as G,P as H,N as I,a as J}from"./swiper-vue-CAAtpb_u.js";import{u as K}from"./index-DgbY2bVZ.js";import"./BaseSelect-CjHNHxoA.js";import"./el-select-TjmoyRv4.js";import"./el-popper-CQfDklFt.js";import"./use-form-item-BvlkXuTg.js";import"./el-scrollbar-CKEGfXcu.js";import"./castArray-Chg9YDBv.js";import"./index-Bxx0gF-o.js";import"./index-C7BRSY9f.js";F.register(...O);const Q={class:"mx-auto w-full max-w-2xl p-4"},X=y({__name:"BaseChartPie",props:{datasets:{default:()=>[]},isLoading:{type:Boolean,default:!1}},setup(m){const r=s(null),e=m;N(()=>e.datasets,()=>{e.datasets.length&&i()}),S(()=>{});const i=()=>{const l=r.value.getContext("2d");l&&new F(l,{type:"pie",data:{labels:e.datasets.map(t=>t.range),datasets:[{data:e.datasets.map(t=>t.value),backgroundColor:["rgba(255, 99, 132, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)"],borderWidth:1}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Phân bố độ tuổi"},tooltip:{callbacks:{label:function(t){let n=t.label+" tuổi"||"";return n&&(n+=": "),t.parsed!==null&&(n+=t.parsed+" người"),n}}}}}})};return(l,t)=>(p(),D("div",Q,[c("canvas",{ref_key:"chartRef",ref:r},null,512)]))}}),Z={class:"rounded-lg border border-solid border-[#DBDBDB] px-4 py-6"},aa={class:"mb-2 flex items-center justify-between"},ta={class:"text-[#5B616E]"},ea={class:"text-2xl font-semibold text-[var(--dr-text-input-label-mobile)]"},oa=y({__name:"BaseSummary",props:{dataSummary:{default:()=>[]},isLoading:{type:Boolean,default:!1}},setup(m){const r=[H,I],e=m;return(i,l)=>{const t=W,n=U;return p(),f(b(G),{ref:"{swiperRef}","slides-per-view":4,"space-between":30,pagination:{type:"fraction"},navigation:!0,modules:r,class:"my-swiper"},{default:B(()=>[e.isLoading?(p(),f(t,{key:0})):(p(!0),D(k,{key:1},Y(e.dataSummary,(u,d)=>(p(),f(b(J),{key:d},{default:B(()=>[c("div",Z,[c("div",aa,[c("span",ta,w(u.title),1),h(n,{name:u.icon,size:"24",style:$({color:u.color})},null,8,["name","style"])]),c("span",ea,[c("span",null,w(u.value),1)])])]),_:2},1024))),128))]),_:1},512)}}}),ba=y({__name:"ReportView",setup(m){S(()=>{Promise.all([C(),T(),M()])});const r=s("7_DAYS"),e=s(!1),i=s(!1),l=s(!1),t=s({totalDepartment:0,totalDoctor:0,totalPatient:0,totalSchedule:0,totalSpecialize:0}),n=s([]),u=s([]),d=s([]),A=s([{name:"Số lượng bệnh nhân",color:"#0A94FF"}]),v=s({groupType:1,fromDate:"",toDate:""}),R=V(()=>[{title:"Tổng số bác sĩ",icon:"total-doctor",color:"#0151FC",value:t.value.totalDoctor},{title:"Tổng số bệnh nhân",icon:"menu-user",color:"#FD2E58",value:t.value.totalPatient},{title:"Tổng số chuyên khoa",icon:"total-department",color:"#00A811",value:t.value.totalDepartment},{title:"Tổng số gói khám",icon:"total-package",color:"#FF9E0C",value:t.value.totalSpecialize},{title:"Tổng số lượt đặt khám",icon:"total-booking",color:"#FF4A4A",value:t.value.totalSchedule}]),T=async()=>{try{e.value=!0;const a=await _.getDataReport();t.value={...a.value},e.value=!1}catch(a){e.value=!1,console.log(a)}},L=a=>{r.value=a,C()},E=()=>{const a=new Date,o=x(new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),"TO"),g=r.value.split("_")[0],z=x(new Date(a.getFullYear(),a.getMonth(),a.getDate()-Number(g),0,0,0,0),"FROM");v.value.fromDate=z,v.value.toDate=o},C=async()=>{try{i.value=!0,E();const a={...v.value,groupType:r.value==="360_DAYS"?3:1},o=await _.getDataChartReport(a);P(o),i.value=!1}catch(a){i.value=!1,console.log(a)}},M=async()=>{try{l.value=!0;const a=await _.getDataChartAge();n.value=a.value,l.value=!1}catch(a){console.log(a),l.value=!1}},P=a=>{u.value=[],d.value=[];const o=[];q(a.value,g=>{u.value.push(K(g.time,"MMM DD").value),o.push(g.value)}),d.value.push({label:"Số lượng bệnh nhân",data:o,tension:.2,borderColor:"#027BFE"})};return(a,o)=>(p(),D(k,null,[h(oa,{"data-summary":b(R),"is-loading":e.value},null,8,["data-summary","is-loading"]),o[0]||(o[0]=c("p",{class:"mt-4 text-2xl font-semibold"},"Biểu đồ thống kê bệnh nhân đặt lịch khám",-1)),h(j,{label:u.value,"legend-chart":A.value,datasets:d.value,"is-loading":i.value,onFilter:L},null,8,["label","legend-chart","datasets","is-loading"]),o[1]||(o[1]=c("p",{class:"my-10 text-2xl font-semibold"},"Biểu đồ thống kê độ tuổi bệnh nhân",-1)),h(X,{datasets:n.value,"is-loading":l.value},null,8,["datasets","is-loading"])],64))}});export{ba as default};
