import{_ as re}from"./BaseButton-CbSB6u_S.js";import{W as ce,X as F,b1 as be,a6 as ee,e as P,d as R,b as Z,o as k,c as b,F as V,q as U,t as S,f as n,v as te,a as e,n as C,r as H,g as de,y as E,aq as ue,b2 as Y,s as I,p as B,J as j,a8 as ne,a0 as se,a1 as oe,m as q,w as Ce,D as we,l as $e,k as Ie,A as Me,O as Se,P as Q,K as Be,H as le,Q as Ee,_ as Pe}from"./index-CqgOdNYt.js";/* empty css                 */import{E as X,a as Oe}from"./el-button-ATXhi7WE.js";/* empty css                        */import{_ as Ve}from"./BasePagination-BLZGtuli.js";import{_ as Te,a as Ne}from"./BaseLoading-DeAHODuT.js";import{_ as je}from"./BaseIcon.vue_vue_type_script_setup_true_lang-owoGvwO6.js";import{_ as ze}from"./bac_si_gia_dinh-DoifZgVA.js";import{D as Le}from"./index-B9kqzngz.js";import{u as me}from"./useFormatCurrency-DyMudwlN.js";import{_ as Ae}from"./BasePopup-AaqJ7hLQ.js";import{r as L,d as A,l as Re,W as J}from"./localeData-DXAO-tuS.js";import{I as pe,U as ge}from"./index-Ch5r5WXF.js";import{E as Ue}from"./index-D84KRRTL.js";import"./index-DOFpVNdE.js";import"./use-form-item-BC93is3T.js";import"./el-select-BcNcokM8.js";import"./el-popper-DlTLAR--.js";import"./el-scrollbar-A36PJo3w.js";import"./castArray-D4q9VKuy.js";import"./index-NPsDvaP9.js";import"./refs-Dz2fHOQH.js";const Fe=(a,c)=>{const v=a.subtract(1,"month").endOf("month").date();return L(c).map((l,y)=>v-(c-y-1))},He=a=>{const c=a.daysInMonth();return L(c).map((v,l)=>l+1)},Ye=a=>L(a.length/7).map(c=>{const v=c*7;return a.slice(v,v+7)}),qe=ce({selectedDay:{type:F(Object)},range:{type:F(Array)},date:{type:F(Object),required:!0},hideHeader:{type:Boolean}}),We={pick:a=>be(a)},Ge=(a,c)=>{A.extend(Re);const v=A.localeData().firstDayOfWeek(),{t:l,lang:y}=ee(),s=A().locale(y.value),f=P(()=>!!a.range&&!!a.range.length),d=P(()=>{let i=[];if(f.value){const[o,p]=a.range,D=L(p.date()-o.date()+1).map(m=>({text:o.date()+m,type:"current"}));let r=D.length%7;r=r===0?0:7-r;const g=L(r).map((m,$)=>({text:$+1,type:"next"}));i=D.concat(g)}else{const o=a.date.startOf("month").day(),p=Fe(a.date,(o-v+7)%7).map(m=>({text:m,type:"prev"})),D=He(a.date).map(m=>({text:m,type:"current"}));i=[...p,...D];const r=7-(i.length%7||7),g=L(r).map((m,$)=>({text:$+1,type:"next"}));i=i.concat(g)}return Ye(i)}),h=P(()=>{const i=v;return i===0?J.map(o=>l(`el.datepicker.weeks.${o}`)):J.slice(i).concat(J.slice(0,i)).map(o=>l(`el.datepicker.weeks.${o}`))}),w=(i,o)=>{switch(o){case"prev":return a.date.startOf("month").subtract(1,"month").date(i);case"next":return a.date.startOf("month").add(1,"month").date(i);case"current":return a.date.date(i)}};return{now:s,isInRange:f,rows:d,weekDays:h,getFormattedDate:w,handlePickDay:({text:i,type:o})=>{const p=w(i,o);c("pick",p)},getSlotData:({text:i,type:o})=>{const p=w(i,o);return{isSelected:p.isSame(a.selectedDay),type:`${o}-month`,day:p.format("YYYY-MM-DD"),date:p.toDate()}}}},Ke=R({name:"DateTable"}),Qe=R({...Ke,props:qe,emits:We,setup(a,{expose:c,emit:v}){const l=a,{isInRange:y,now:s,rows:f,weekDays:d,getFormattedDate:h,handlePickDay:w,getSlotData:M}=Ge(l,v),u=Z("calendar-table"),i=Z("calendar-day"),o=({text:p,type:D})=>{const r=[D];if(D==="current"){const g=h(p,D);g.isSame(l.selectedDay,"day")&&r.push(i.is("selected")),g.isSame(s,"day")&&r.push(i.is("today"))}return r};return c({getFormattedDate:h}),(p,D)=>(k(),b("table",{class:C([n(u).b(),n(u).is("range",n(y))]),cellspacing:"0",cellpadding:"0"},[p.hideHeader?te("v-if",!0):(k(),b("thead",{key:0},[(k(!0),b(V,null,U(n(d),r=>(k(),b("th",{key:r},S(r),1))),128))])),e("tbody",null,[(k(!0),b(V,null,U(n(f),(r,g)=>(k(),b("tr",{key:g,class:C({[n(u).e("row")]:!0,[n(u).em("row","hide-border")]:g===0&&p.hideHeader})},[(k(!0),b(V,null,U(r,(m,$)=>(k(),b("td",{key:$,class:C(o(m)),onClick:T=>n(w)(m)},[e("div",{class:C(n(i).b())},[H(p.$slots,"date-cell",{data:n(M)(m)},()=>[e("span",null,S(m.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var ie=de(Qe,[["__file","date-table.vue"]]);const Xe=(a,c)=>{const v=a.endOf("month"),l=c.startOf("month"),s=v.isSame(l,"week")?l.add(1,"week"):l;return[[a,v],[s.startOf("week"),c]]},Je=(a,c)=>{const v=a.endOf("month"),l=a.add(1,"month").startOf("month"),y=v.isSame(l,"week")?l.add(1,"week"):l,s=y.endOf("month"),f=c.startOf("month"),d=s.isSame(f,"week")?f.add(1,"week"):f;return[[a,v],[y.startOf("week"),s],[d.startOf("week"),c]]},Ze=(a,c,v)=>{const{lang:l}=ee(),y=E(),s=A().locale(l.value),f=P({get(){return a.modelValue?h.value:y.value},set(r){if(!r)return;y.value=r;const g=r.toDate();c(pe,g),c(ge,g)}}),d=P(()=>{if(!a.range||!ue(a.range)||a.range.length!==2||a.range.some($=>!Y($)))return[];const r=a.range.map($=>A($).locale(l.value)),[g,m]=r;return g.isAfter(m)?[]:g.isSame(m,"month")?o(g,m):g.add(1,"month").month()!==m.month()?[]:o(g,m)}),h=P(()=>a.modelValue?A(a.modelValue).locale(l.value):f.value||(d.value.length?d.value[0][0]:s)),w=P(()=>h.value.subtract(1,"month").date(1)),M=P(()=>h.value.add(1,"month").date(1)),u=P(()=>h.value.subtract(1,"year").date(1)),i=P(()=>h.value.add(1,"year").date(1)),o=(r,g)=>{const m=r.startOf("week"),$=g.endOf("week"),T=m.get("month"),z=$.get("month");return T===z?[[m,$]]:(T+1)%12===z?Xe(m,$):T+2===z||(T+1)%11===z?Je(m,$):[]},p=r=>{f.value=r};return{calculateValidatedDateRange:o,date:h,realSelectedDay:f,pickDay:p,selectDate:r=>{const m={"prev-month":w.value,"next-month":M.value,"prev-year":u.value,"next-year":i.value,today:s}[r];m.isSame(h.value,"day")||p(m)},validatedRange:d}},et=a=>ue(a)&&a.length===2&&a.every(c=>Y(c)),tt=ce({modelValue:{type:Date},range:{type:F(Array),validator:et}}),at={[ge]:a=>Y(a),[pe]:a=>Y(a)},nt="ElCalendar",st=R({name:nt}),ot=R({...st,props:tt,emits:at,setup(a,{expose:c,emit:v}){const l=a,y=Z("calendar"),{calculateValidatedDateRange:s,date:f,pickDay:d,realSelectedDay:h,selectDate:w,validatedRange:M}=Ze(l,v),{t:u}=ee(),i=P(()=>{const o=`el.datepicker.month${f.value.format("M")}`;return`${f.value.year()} ${u("el.datepicker.year")} ${u(o)}`});return c({selectedDay:h,pickDay:d,selectDate:w,calculateValidatedDateRange:s}),(o,p)=>(k(),b("div",{class:C(n(y).b())},[e("div",{class:C(n(y).e("header"))},[H(o.$slots,"header",{date:n(i)},()=>[e("div",{class:C(n(y).e("title"))},S(n(i)),3),n(M).length===0?(k(),b("div",{key:0,class:C(n(y).e("button-group"))},[I(n(Oe),null,{default:B(()=>[I(n(X),{size:"small",onClick:D=>n(w)("prev-month")},{default:B(()=>[j(S(n(u)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),I(n(X),{size:"small",onClick:D=>n(w)("today")},{default:B(()=>[j(S(n(u)("el.datepicker.today")),1)]),_:1},8,["onClick"]),I(n(X),{size:"small",onClick:D=>n(w)("next-month")},{default:B(()=>[j(S(n(u)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):te("v-if",!0)])],2),n(M).length===0?(k(),b("div",{key:0,class:C(n(y).e("body"))},[I(ie,{date:n(f),"selected-day":n(h),onPick:n(d)},ne({_:2},[o.$slots["date-cell"]?{name:"date-cell",fn:B(D=>[H(o.$slots,"date-cell",se(oe(D)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(k(),b("div",{key:1,class:C(n(y).e("body"))},[(k(!0),b(V,null,U(n(M),(D,r)=>(k(),q(ie,{key:r,date:D[0],"selected-day":n(h),range:D,"hide-header":r!==0,onPick:n(d)},ne({_:2},[o.$slots["date-cell"]?{name:"date-cell",fn:B(g=>[H(o.$slots,"date-cell",se(oe(g)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var lt=de(ot,[["__file","calendar.vue"]]);const it=Ce(lt),rt={class:"space-y-3"},ct={class:"text-xl"},dt={class:"text-xl"},ut={class:"text-xl"},mt={class:"text-xl"},pt={class:"text-xl"},gt={class:"flex items-center justify-end space-x-3"},vt=R({__name:"PopupConfirmBooking",props:{data:{default:()=>({})},bookingInfo:{default:()=>({})},nameDepartment:{default:""},isLoadingBooking:{type:Boolean,default:!1}},emits:["cancel","booking"],setup(a,{emit:c}){const v=c,l=a;return(y,s)=>{const f=re,d=Ae;return k(),q(d,{name:"popup-confirm-booking",width:"480"},{title:B(()=>s[2]||(s[2]=[j(" Xác nhận thông tin đặt lịch ")])),footer:B(()=>[e("div",gt,[I(f,{type:"plain",size:"small",class:"w-20",onClick:s[0]||(s[0]=h=>v("cancel"))},{default:B(()=>s[8]||(s[8]=[j("Hủy")])),_:1}),I(f,{loading:l.isLoadingBooking,size:"small",class:"w-24",onClick:s[1]||(s[1]=h=>v("booking"))},{default:B(()=>s[9]||(s[9]=[j("Đặt lịch")])),_:1},8,["loading"])])]),default:B(()=>[e("div",rt,[e("p",ct,[s[3]||(s[3]=e("span",null," Chuyên khoa: ",-1)),e("strong",null,S(l.nameDepartment),1)]),e("p",dt,[s[4]||(s[4]=e("span",null," Gói khám: ",-1)),e("strong",null,S(l.bookingInfo.packageName),1)]),e("p",ut,[s[5]||(s[5]=e("span",null," Bác sĩ: ",-1)),e("strong",null,S(l.bookingInfo.doctorName),1)]),e("p",mt,[s[6]||(s[6]=e("span",null," Thời gian: ",-1)),e("strong",null,S(l.bookingInfo.time),1)]),e("p",pt,[s[7]||(s[7]=e("span",null," Tiền khám: ",-1)),e("strong",null,S(n(me)(l.bookingInfo.price)),1)])])]),_:1})}}}),ft={class:"container mt-4"},kt={class:"mb-10"},yt={class:"my-5 flex items-center justify-start space-x-2"},ht={class:"bg-[#e8f2f7] py-10"},_t={class:"container"},Dt={key:1,class:"box-package"},xt=["onClick"],bt={class:"ml-3 w-full"},Ct={class:"text-2xl font-medium"},wt={class:"flex items-center justify-between"},$t={class:"text-xl font-bold text-[#ffb54a]"},It={class:"mx-[26px] mb-[26px]"},Mt={key:1,class:"box-package"},St={class:"m-[26px]"},Bt={class:"w-full text-center"},Et={class:"mb-4"},Pt={class:"flex justify-around"},Ot={class:"mb-8"},Vt={class:"flex justify-around"},Tt={class:"mt-8"},Nt=R({__name:"BookingView",setup(a){const{setOpenPopup:c}=we(),{patient:v}=$e(),l=Ie();Me(()=>{g()});const y=sessionStorage.getItem("department-name"),s=E(),f=E(new Date),d=E(""),h=E([]),w=E({}),M=E(!1),u=E({...Le}),i=E(!1),o=E(!1),p=E({}),D=E({doctorName:"",packageName:"",price:""}),r=()=>{Q.push({name:"Home"})},g=async()=>{try{u.value.loading=!0;const _=l.params.idDepartment,t=await Se.getListByDeparmentId(u.value,_);h.value=t.value.contentResponse,u.value.totalElements=t.value.totalElements,u.value.loading=!1}catch(_){u.value.loading=!1,console.log(_)}},m=_=>{u.value.pageSize=_,u.value.pageIndex=1,g()},$=_=>{u.value.pageIndex=_,g()},T=()=>{M.value=!1,f.value=new Date,d.value="",p.value={patientId:"",doctorId:"",specializeId:"",checkIn:"",note:""}},z=_=>{M.value=!0,w.value=_},ae=_=>{s.value&&s.value.selectDate(_)},O=_=>{d.value=_},ve=async()=>{try{o.value=!0;const _=l.params.idDoctor,t=`${f.value.toISOString().split("T")[0]} ${d.value}`,N=new Date(t).toISOString(),W=N.substring(0,N.length-1),G=await Be.getDoctorById(_);D.value={doctorName:G.value.info.name,packageName:w.value.name,price:w.value.price,time:t},p.value={...p.value,patientId:v.id,doctorId:l.params.idDoctor,specializeId:w.value.id,checkIn:W},o.value=!1,c("popup-confirm-booking")}catch(_){o.value=!1,console.log(_)}},fe=()=>{c("popup-confirm-booking",!1)},ke=async()=>{if(!v.id){Q.push({name:"EditUser"}),le.warning("Vui lòng cập nhật Thông tin bệnh nhân");return}try{i.value=!0;const _=await Ee.booking(p.value);le.success(_.message),c("popup-confirm-booking",!1),Q.push({name:"Home"}),i.value=!1}catch(_){i.value=!1,console.log(_)}},ye=P(()=>!d.value);return(_,t)=>{const N=je,W=Te,G=Ne,he=Ve,_e=it,De=Ue,xe=re;return k(),b(V,null,[e("div",ft,[e("div",kt,[e("p",yt,[e("span",{class:"cursor-pointer text-base font-semibold",onClick:r},"Trang chủ"),I(N,{name:"arrow-right"}),e("span",{class:C(["cursor-pointer font-semibold",{"text-primary":!M.value}]),onClick:T},"Chọn gói khám",2),M.value?(k(),b(V,{key:0},[I(N,{name:"arrow-right"}),t[14]||(t[14]=e("span",{class:"font-semibold text-primary"},"Chọn ngày khám",-1))],64)):te("",!0)])])]),e("div",ht,[e("div",_t,[M.value?(k(),b("div",Mt,[t[22]||(t[22]=e("div",{class:"header"},[e("p",{class:"text-center text-2xl font-semibold"},"Vui lòng chọn thời gian khám")],-1)),e("div",St,[I(_e,{ref_key:"calendar",ref:s,modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=x=>f.value=x),class:"calender"},{header:B(({date:x})=>[I(N,{name:"arrow-left",class:"cursor-pointer",onClick:t[2]||(t[2]=K=>ae("prev-month"))}),e("p",Bt,S(x),1),I(N,{name:"arrow-right2",class:"cursor-pointer",onClick:t[3]||(t[3]=K=>ae("next-month"))})]),_:1},8,["modelValue"]),e("div",Et,[t[17]||(t[17]=e("p",{class:"mb-3 text-xl font-semibold"},"Buổi sáng",-1)),e("ul",Pt,[e("li",{class:C(["hour",{active:d.value==="07:00:00"}]),onClick:t[5]||(t[5]=x=>O("07:00:00"))}," 07:00 - 08:00 ",2),e("li",{class:C(["hour",{active:d.value==="08:00:00"}]),onClick:t[6]||(t[6]=x=>O("08:00:00"))}," 08:00 - 09:00 ",2),e("li",{class:C(["hour",{active:d.value==="09:00:00"}]),onClick:t[7]||(t[7]=x=>O("09:00:00"))}," 09:00 - 10:00 ",2),e("li",{class:C(["hour",{active:d.value==="10:00:00"}]),onClick:t[8]||(t[8]=x=>O("10:00:00"))}," 10:00 - 11:00 ",2)])]),e("div",Ot,[t[18]||(t[18]=e("p",{class:"mb-3 text-xl font-semibold"},"Buổi chiều",-1)),e("ul",Vt,[e("li",{class:C(["hour",{active:d.value==="13:00:00"}]),onClick:t[9]||(t[9]=x=>O("13:00:00"))}," 13:00 - 14:00 ",2),e("li",{class:C(["hour",{active:d.value==="14:00:00"}]),onClick:t[10]||(t[10]=x=>O("14:00:00"))}," 14:00 - 15:00 ",2),e("li",{class:C(["hour",{active:d.value==="15:00:00"}]),onClick:t[11]||(t[11]=x=>O("15:00:00"))}," 15:00 - 16:00 ",2),e("li",{class:C(["hour",{active:d.value==="16:00:00"}]),onClick:t[12]||(t[12]=x=>O("16:00:00"))}," 16:00 - 17:00 ",2)])]),t[21]||(t[21]=e("p",{class:"text-lg text-[#d98634]"},"Tất cả thời gian theo múi giờ Việt Nam GMT +7",-1)),e("div",Tt,[t[19]||(t[19]=e("p",{class:"mb-3 text-xl"},"Ghi chú",-1)),I(De,{modelValue:p.value.note,"onUpdate:modelValue":t[13]||(t[13]=x=>p.value.note=x),class:"input",style:{height:"50px",width:"100%"},autosize:{minRows:2},type:"textarea",placeholder:"Vui lòng nhập ghi chú"},null,8,["modelValue"])]),I(xe,{loading:o.value,disabled:n(ye),size:"small",class:"mt-8",onClick:ve},{default:B(()=>t[20]||(t[20]=[j("Tiếp tục")])),_:1},8,["loading","disabled"])])])):(k(),b(V,{key:0},[u.value.loading?(k(),q(W,{key:0})):(k(),b("div",Dt,[t[16]||(t[16]=e("div",{class:"header"},[e("p",{class:"text-center text-2xl font-semibold"},"Vui lòng chọn gói khám")],-1)),h.value.length?(k(!0),b(V,{key:1},U(h.value,(x,K)=>(k(),b("div",{key:K,class:"flex items-center justify-center"},[e("div",{class:"card-item",onClick:jt=>z(x)},[t[15]||(t[15]=e("img",{src:ze,alt:""},null,-1)),e("div",bt,[e("p",Ct,S(x.name),1),e("div",wt,[e("p",$t,"Giá: "+S(n(me)(x.price)),1)])])],8,xt)]))),128)):(k(),q(G,{key:0})),e("div",It,[I(he,{"page-index":u.value.pageIndex,"onUpdate:pageIndex":t[0]||(t[0]=x=>u.value.pageIndex=x),"page-size":u.value.pageSize,"onUpdate:pageSize":t[1]||(t[1]=x=>u.value.pageSize=x),query:u.value,label:"gói khám",onLimitChange:m,onPageChange:$},null,8,["page-index","page-size","query"])])]))],64))])]),I(vt,{"is-loading-booking":i.value,data:p.value,"name-department":n(y),"booking-info":D.value,onBooking:ke,onCancel:fe},null,8,["is-loading-booking","data","name-department","booking-info"])],64)}}}),ia=Pe(Nt,[["__scopeId","data-v-7a0f7885"]]);export{ia as default};
